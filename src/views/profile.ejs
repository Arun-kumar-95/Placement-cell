<link rel="stylesheet" href="../css/dashboard.css">
<link rel="stylesheet" href="../css/profile.css">
<link rel="stylesheet" href="../css/error.css">

<script defer src="../js/toggler.js" type="text/javascript"></script>
<script src="../js/notification.js" type="text/javascript" defer></script>
<script src="../js/profile.js" type="text/javascript" defer></script>
<script src="../js/Helpers.js" type="text/javascript" defer></script>
<script defer src="./js/logout.js" type="text/javascript"></script>


<div class="dashboard-wrapper">
    <div class="dashboard-container">
        <div class="dashboard">

            <!-- side bar -->
            <%- include("./partials/_sidebar"); %>


                <div class="dashboard-main">

                    <!-- notofication pannel -->
                    <%- include("./partials/_notification"); %>

                        <div class="notification__pannel" style="visibility:hidden">
                            <div class=" notify-slider" aria-hidden="true">
                                <button class="close__notify">&times</button>
                                <div class="keepOpen"></div>

                                <div class="notification__control">
                                    <div class="btn-notify new__interview active" data-id="new">New Interview</div>
                                    <div class="btn-notify expired__interview" data-id="expired">Expired</div>
                                </div>

                                <ul data-id="new__interview" class="lists">
                                </ul>


                            </div>
                        </div>

                        <!-- notofication pannel -->
                        <%- include("./partials/_topheader"); %>

                            <div class="page-index">
                                <div class="page-header">
                                    <h1>Profile</h1>
                                    <p class="page-title">Admin / <a href="javascript:void(0)">Profile</a></p>
                                </div>
                            </div>


                            <div class="student__profile__wrapper">
                                <div class="student__profile__result">

                                    <% if(data[0].interviews.length> 0){%>

                                        <h2>Results</h2>
                                        <div class="wrapper">
                                            <table>
                                                <thead>
                                                    <th>Sno</th>
                                                    <th>Company</th>
                                                    <th>Role</th>
                                                    <th>College</th>
                                                    <th>Batch</th>

                                                </thead>

                                                <tbody>

                                                    <% data[0].interviews.forEach((item , index)=>{ %>

                                                        <tr>
                                                            <td>
                                                                <span>
                                                                    <%= index + 1%>

                                                                </span>
                                                            </td>

                                                            <td>
                                                                <p>
                                                                    <%= item.company%>
                                                                </p>
                                                            </td>
                                                            <td>
                                                                <p>
                                                                    <%= item.role %>
                                                                </p>
                                                            </td>
                                                            <td>
                                                                <p>
                                                                    <%= data[0].college%>

                                                                </p>
                                                            </td>
                                                            <td>
                                                                <p>
                                                                    <%= data[0].batch %>

                                                                </p>
                                                            </td>
                                                        </tr>
                                                        <%})%>

                                                </tbody>


                                            </table>

                                            <% if(data[0].interviews.length> 0){%>
                                                <table style="width:20%">
                                                    <thead>
                                                        <th>Report</th>
                                                        <th>Status</th>
                                                    </thead>

                                                    <tbody>
                                                        <% data[0].interviews.forEach((item , index)=>{ %>
                                                            <% if(item.results.length==0 ||
                                                                data[0].reports.length==0){%>
                                                                <tr>
                                                                    <td>
                                                                        <form action="" method="post">
                                                                            <button class="btn-result" type="button"
                                                                                data-id="<%= item._id%>">
                                                                                <svg width="20px" height="20px"
                                                                                    fill="currentColor"
                                                                                    viewBox="0 0 24 24"
                                                                                    preserveAspectRatio="xMidYMid meet"
                                                                                    focusable="false">
                                                                                    <g>
                                                                                        <path
                                                                                            d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z">
                                                                                        </path>
                                                                                    </g>
                                                                                </svg>
                                                                            </button>
                                                                        </form>

                                                                    </td>

                                                                    <td>
                                                                        <p> NC
                                                                        </p>

                                                                    </td>
                                                                </tr>
                                                                <%}else{%>

                                                                    <!-- if length == 0 -->
                                                                    <% data[0].reports.forEach((report , count)=>{ %>

                                                                        <% if(item._id==report.company.toString()){%>
                                                                            <tr>
                                                                                <td>
                                                                                    <form action="" method="post">
                                                                                        <button class="btn-result"
                                                                                            type="button"
                                                                                            data-id="<%= item._id%>"
                                                                                            style="pointer-events: none;">
                                                                                            <svg width="20px"
                                                                                                height="20px"
                                                                                                fill="currentColor"
                                                                                                viewBox="0 0 24 24"
                                                                                                preserveAspectRatio="xMidYMid meet"
                                                                                                focusable="false">
                                                                                                <g>
                                                                                                    <path
                                                                                                        d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z">
                                                                                                    </path>
                                                                                                </g>
                                                                                            </svg>
                                                                                        </button>
                                                                                    </form>

                                                                                </td>

                                                                                <td>
                                                                                    <p>
                                                                                        <%= report.result %>
                                                                                    </p>

                                                                                </td>
                                                                            </tr>
                                                                            <%}%>
                                                                                <%})%>
                                                                                    <%}%>
                                                                                        <%})%>

                                                    </tbody>
                                                </table>
                                                <%}%>
                                        </div>

                                        <%}else{%>
                                            <h2 style="color:red;">*No Interview applied</h2>
                                            <%}%>

                                </div>

                                <!-- INTERVIEW LISTS -->
                                <div class="student__profile__interview__list">
                                    <div class="interview__lists">
                                        <% if(data[1].interviewLists.length> 0){%>
                                            <h2>Apply for Interviews</h2>

                                            <table>
                                                <thead>
                                                    <th>Sno</th>
                                                    <th>Company</th>
                                                    <th>Role</th>
                                                    <th>Date</th>
                                                    <th style="text-align:left;">Venue</th>
                                                    <th>Apply</th>
                                                </thead>
                                                <% data[1].interviewLists.forEach((item , index)=>{ %>

                                                    <tr>
                                                        <td>
                                                            <p>
                                                                <%= index + 1%>

                                                            </p>
                                                        </td>
                                                        <td>
                                                            <p>

                                                                <%= item.company%>
                                                            </p>
                                                        </td>
                                                        <td>
                                                            <p>
                                                                <%= item.role%>

                                                            </p>
                                                        </td>
                                                        <td>
                                                            <p>
                                                                <%= item.date.toDateString()%>

                                                            </p>
                                                        </td>

                                                        <td>
                                                            <p style="text-align: left;">
                                                                <%= item.venue %>
                                                            </p>
                                                        </td>
                                                        <td>
                                                            <% if(item.appliedStudents.includes(data[1].id)) {%>
                                                                <form action="" method="post">
                                                                    <button type="submit"
                                                                        class="applied__for__interview"
                                                                        data-id="<%= item._id%>">Applied</button>
                                                                </form>
                                                                <%}else{%>

                                                                    <form action="" method="post">
                                                                        <button type="submit"
                                                                            class="apply__for__interview"
                                                                            data-id="<%= item._id%>">Apply</button>
                                                                    </form>
                                                                    <%}%>
                                                        </td>


                                                    </tr>

                                                    <% }) %>

                                                        <tbody>

                                                        </tbody>
                                            </table>

                                            <%} else{%>
                                                <h2 style="color:red">*No Interview created</h2>
                                                <%}%>
                                    </div>


                                </div>
                            </div>


                            <!-- APPLY CONFIRM POPUP -->
                            <div class="apply__pannel__confirmation" style="visibility: hidden">
                                <div class="confirmation__container">
                                    <p>Are you sure you want to continue ?</p>
                                    <div class="btn__controls">
                                        <button class="btn btn-apply-yes">Yes</button>
                                        <button class="btn btn-cancel">Cancel</button>

                                    </div>
                                </div>
                            </div>

                            <!-- CREATE REPORT FORM -->


                            <div class="create__report__student__form" style="visibility: hidden;">
                                <div class="create__report">
                                    <h2>Select the status</h2>
                                    <p class="warning" style="opacity: 0;color:red; margin-bottom:0.5em"></p>

                                    <select name="result" id="result">
                                        <option value="">Select result</option>
                                        <option value="PASS">PASS</option>
                                        <option value="FAIL">FAIL </option>
                                        <option value="OnHold">OnHold </option>
                                        <option value="Didn't Attempt">Didn't Attempt</option>
                                    </select>

                                    <div class="btn__controls">
                                        <button class="btn btnReport" type="button">Create Report</button>
                                        <button class="btn btnCancelReport" type="button">Cancel</button>
                                    </div>

                                    < </div>
                                </div>




                            </div> <!-- /dashboard main -->



                </div> <!-- /dashboard -->

        </div> <!-- /dashboard container-->
    </div>